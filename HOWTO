# Howto .. in short


If you'd like to try this minilib,
there are two ways:

1. (The faster one) - but sometimes won't work, 
		as long as I'm restructuring the whole lib

  download minilibcompiled.h
    wget https://raw.githubusercontent.com/michael105/minilib/master/minilibcompiled.h


  download hello-combined.c
  (source attached below, with explanations..)
    wget https://raw.githubusercontent.com/michael105/minilib/master/hello-combined.h

  compile:

	gcc -o hello-combined hello-combined.c -static -nostdlib -nodefaultlibs -nostartfiles -Wl,-n,-s,--gc-sections,-nostdlib


... which results in an 1k executable.

	so you might also download the linker script "ld.script.onlytext" from the folder ldscripts and compile with it
	  also the Option -Os strips a few bytes:
	gcc -o hello-combined hello-combined.c -static -nostdlib -nodefaultlibs -nostartfiles -Wl,-n,-s,--gc-sections,-nostdlib-T./ld.script.onlytext -Os

  We're down to 400 Bytes..
	The tool "elfshrink" out of the folder minilib/tools brings this further down, now 185 Bytes here.



2. Or clone the git.. 

(I recommend. If something's broken, 
 it might be nearly impossible to find 
 within the huge combined file)


git clone https://github.com/michael105/minilib.git minilib

copy minilib/Makefile.template ./Makefile

  (edit Makefile. set "PROG" to your program's name)

copy minilib/minilib.conf ./
  
  (edit minilib.conf and uncomment functions, you need.
   Only functions, you define to be build in minilib.conf
   will be included)


add the lines below to you source(s)
#include "minilib.conf"
#define INCLUDESRC
#include "minilib/minilib.h"

make

	(Optionally, linux 64bit only for now) 

	  cd tools; make; cd ..
		./tools/shrinkelf hello-combined




=======================================
file:    hello-combined.c
=======================================

  // build start, the entry point for the OS
#define mini_start

  // define and build the function "write"
#define mini_write

 // build on OSX ( atm I can't check whether 32bit linux works )
#define OSX

 // build with 64bit
#define X64

 // include definitions as well as the sources.
#define INCLUDESRC

 // Only functions, you define before, will be built.
#include "minilibcompiled.h"

int main(){
		write(stdout, "Hello world!\n", 13);
		return(0);
}


