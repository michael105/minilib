<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.14: http://docutils.sourceforge.net/" />
<title>setuid.2.rst</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<hr class="docutils" />
<p>SETUID(2) BSD System Calls Manual SETUID(2)</p>
<p><strong>NAME</strong></p>
<p><strong>setuid</strong>, <strong>seteuid</strong>, <strong>setgid</strong>, <strong>setegid</strong> — set user and group ID</p>
<p><strong>LIBRARY</strong></p>
<p>Standard C&nbsp;Library (libc, −lc)</p>
<p><strong>SYNOPSIS</strong></p>
<p><strong>#include &lt;unistd.h&gt;</strong></p>
<p><em>int</em></p>
<p><strong>setuid</strong>(<em>uid_t&nbsp;uid</em>);</p>
<p><em>int</em></p>
<p><strong>seteuid</strong>(<em>uid_t&nbsp;euid</em>);</p>
<p><em>int</em></p>
<p><strong>setgid</strong>(<em>gid_t&nbsp;gid</em>);</p>
<p><em>int</em></p>
<p><strong>setegid</strong>(<em>gid_t&nbsp;egid</em>);</p>
<p><strong>DESCRIPTION</strong></p>
<p>The <strong>setuid</strong>() system call sets the real and effective user IDs and
the saved set-user-ID of the current process to the specified value. The
<strong>setuid</strong>() system call is permitted if the specified ID is equal to
the real user ID or the effective user ID of the process, or if the
effective user ID is that of the super user.</p>
<p>The <strong>setgid</strong>() system call sets the real and effective group IDs and
the saved set-group-ID of the current process to the specified value.
The <strong>setgid</strong>() system call is permitted if the specified ID is equal
to the real group ID or the effective group ID of the process, or if the
effective user ID is that of the super user.</p>
<p>The <strong>seteuid</strong>() system call (<strong>setegid</strong>()) sets the effective
user ID (group ID) of the current process. The effective user ID may be
set to the value of the real user ID or the saved set-user-ID (see
intro(2) and execve(2)); in this way, the effective user ID of a
set-user-ID executable may be toggled by switching to the real user ID,
then re-enabled by reverting to the set-user-ID value. Similarly, the
effective group ID may be set to the value of the real group ID or the
saved set-group-ID.</p>
<p><strong>RETURN VALUES</strong></p>
<p>Upon successful completion, the value&nbsp;0 is returned; otherwise the
value&nbsp;−1 is returned and the global variable <em>errno</em> is set to indicate
the error.</p>
<p><strong>ERRORS</strong></p>
<p>The system calls will fail if:</p>
<p>[EPERM]</p>
<p>The user is not the super user and the ID specified is not the real,
effective ID, or saved ID.</p>
<p><strong>SEE ALSO</strong></p>
<p>getgid(2), getuid(2), issetugid(2), setregid(2), setreuid(2)</p>
<p><strong>STANDARDS</strong></p>
<p>The <strong>setuid</strong>() and <strong>setgid</strong>() system calls are compliant with
the ISO/IEC 9945-1:1990 (‘‘POSIX.1’’) specification with
_POSIX_SAVED_IDS not defined with the permitted extensions from
Appendix B.4.2.2. The <strong>seteuid</strong>() and <strong>setegid</strong>() system calls
are extensions based on the POSIX concept of _POSIX_SAVED_IDS, and have
been proposed for a future revision of the standard.</p>
<p><strong>HISTORY</strong></p>
<p>The <strong>setuid</strong>() function appeared in Version&nbsp;1 AT&amp;T UNIX. The
<strong>setgid</strong>() function appeared in Version&nbsp;4 AT&amp;T UNIX.</p>
<p><strong>SECURITY CONSIDERATIONS</strong></p>
<p>Read and write permissions to files are determined upon a call to
open(2). Once a file descriptor is open, dropping privilege does not
affect the process’s read/write permissions, even if the user ID
specified has no read or write permissions to the file. These files
normally remain open in any new process executed, resulting in a user
being able to read or modify potentially sensitive data.</p>
<p>To prevent these files from remaining open after an exec(3) call, be
sure to set the close-on-exec flag:</p>
<div class="line-block">
<div class="line">void</div>
<div class="line">pseudocode(void)</div>
<div class="line">{</div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr><td>&nbsp;</td>
<td>int fd;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td>&nbsp;</td>
<td>/* ... */</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td>&nbsp;</td>
<td>fd =
open(&quot;/path/to/
sensitive/data&quot;
,
O_RDWR |
O_CLOEXEC);</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td>&nbsp;</td>
<td>if (fd == -1)</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td>&nbsp;</td>
<td>&nbsp;</td>
<td>err(1, &quot;open&quot;);</td>
<td>&nbsp;</td>
</tr>
<tr><td>&nbsp;</td>
<td>/* ... */</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td>&nbsp;</td>
<td>execve(path,
argv, environ);</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>}</p>
<p>BSD December&nbsp;15, 2015 BSD</p>
<hr class="docutils" />
<!-- Copyright (c) 1990, 1991, 1993 -->
<!-- The Regents of the University of California.  All rights reserved. -->
<!--  -->
<!-- This code is derived from software contributed to Berkeley by -->
<!-- Chris Torek and the American National Standards Committee X3, -->
<!-- on Information Processing Systems. -->
<!--  -->
<!-- Redistribution and use in source and binary forms, with or without -->
<!-- modification, are permitted provided that the following conditions -->
<!-- are met: -->
<!-- 1. Redistributions of source code must retain the above copyright -->
<!-- notice, this list of conditions and the following disclaimer. -->
<!-- 2. Redistributions in binary form must reproduce the above copyright -->
<!-- notice, this list of conditions and the following disclaimer in the -->
<!-- documentation and/or other materials provided with the distribution. -->
<!-- 3. Neither the name of the University nor the names of its contributors -->
<!-- may be used to endorse or promote products derived from this software -->
<!-- without specific prior written permission. -->
<!--  -->
<!-- THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND -->
<!-- ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE -->
<!-- IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE -->
<!-- ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE -->
<!-- FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL -->
<!-- DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS -->
<!-- OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) -->
<!-- HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT -->
<!-- LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY -->
<!-- OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF -->
<!-- SUCH DAMAGE. -->
</div>
</body>
</html>
